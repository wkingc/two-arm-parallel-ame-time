<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Wade K. Copeland" />


<title>Average Marginal Effects in 2-Arm Parallel Randomized Controlled Trial Over Time</title>

<script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<script src="index_files/navigation-1.1/codefolding.js"></script>
<link href="index_files/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="index_files/highlightjs-9.12.0/highlight.js"></script>
<link href="index_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="index_files/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="index_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="index_files/datatables-binding-0.33/datatables.js"></script>
<link href="index_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="index_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="index_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<script src="index_files/jszip-1.13.6/jszip.min.js"></script>
<script src="index_files/pdfmake-1.13.6/pdfmake.js"></script>
<script src="index_files/pdfmake-1.13.6/vfs_fonts.js"></script>
<link href="index_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="index_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>
<script src="index_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>
<script src="index_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>
<script src="index_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>
<link href="index_files/dt-ext-keytable-1.13.6/css/keyTable.dataTables.min.css" rel="stylesheet" />
<script src="index_files/dt-ext-keytable-1.13.6/js/dataTables.keyTable.min.js"></script>
<link href="index_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="index_files/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Average Marginal Effects in 2-Arm Parallel Randomized Controlled Trial Over Time</h1>
<h4 class="author">Wade K. Copeland</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In a 2-arm parallel randomized controlled trial (RCT) an outcome of interest is measured at least twice, once before the treatment is administered and once after. However, to measure the stability of an effect over time, additional time points can be added after the first follow-up.</p>
<p>In this presentation, I consider the case where an outcome of interest is measured at a baseline, a second follow-up, and a third follow-up (referred to hereafter as time 1, time 2, and time 3). In this design, it might be of interest to know the treatment effect at the time 3 that is unconditional on the treatment effect at time 2. At present, we derive such an effect and its standard error and apply the theory to a simulated outcome that is correlated over time.</p>
<p>This presentation uses the R programming language and assumes the end user is taking advantage of RStudio IDE to compile their R markdown files into HTML <span class="citation">(<a href="#ref-Rlang2019">R Core Team 2019</a>; <a href="#ref-Rstudio">RStudio Team 2016</a>)</span>. All of the files needed to reproduce these results can be downloaded from the Git repository <a href="https://github.com/wkingc/two-arm-parallel-ame-time" target="_blank">https://github.com/wkingc/two-arm-parallel-ame-time</a>.</p>
</div>
<div id="required-libraries" class="section level1">
<h1>Required Libraries</h1>
<p>The libraries’ <i>knitr</i>, <i>bookdown</i>, <i>kableExtra</i>, and <i>DT</i> are used to generate the HTML output <span class="citation">(<a href="#ref-knitr">Xie 2019</a>, <a href="#ref-bookdown">2018</a>; <a href="#ref-kableExtra">Zhu 2019</a>; <a href="#ref-xie2019">Xie, Cheng, and Tan 2019</a>)</span>. The libraries <i>reshape2</i> and <i>dplyr</i> are loaded for their data manipulation funtions <span class="citation">(<a href="#ref-reshape2">Wickham 2007</a>; <a href="#ref-dplyr">Wickham et al. 2019</a>)</span>. The <i>mvtnorm</i> library is loaded to simulate outcomes that are correlated over time <span class="citation">(<a href="#ref-genz2009">Genz and Bretz 2009</a>; <a href="#ref-genz2019">Genz et al. 2019</a>)</span>. The <i>geepack</i> library is used to estimate parameters of the linear model using the method of generalized estimating equations <span class="citation">(<a href="#ref-geepack2006">Halekoh, Højsgaard, and Yan 2006</a>; <a href="#ref-yan2004">Yan and Fine 2004</a>; <a href="#ref-yan2002">Yan 2002</a>)</span>.</p>
<pre class="r"><code>library(&quot;knitr&quot;)
library(&quot;bookdown&quot;)
library(&quot;kableExtra&quot;)
library(&quot;reshape2&quot;)
library(&quot;dplyr&quot;)
library(&quot;DT&quot;)
library(&quot;mvtnorm&quot;)
library(&quot;geepack&quot;)</code></pre>
</div>
<div id="statistical-methods" class="section level1">
<h1>Statistical Methods</h1>
<div id="notation" class="section level2">
<h2>Notation</h2>
<p>The notation used in this presentation is listed below.</p>
<ol style="list-style-type: decimal">
<li>For observation <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>, let <span class="math inline">\(y_{it}\)</span> be one of up to <span class="math inline">\(n\)</span> outcome random variables, with each <span class="math inline">\(y_{i}\)</span> identically distributed.</li>
<li>Let <span class="math inline">\(c_{it}\)</span> be an indicator for treatment condition, <span class="math inline">\(t^{(2)}_{it}\)</span> be an indicator for time 2, <span class="math inline">\(t^{(3)}_{it}\)</span> be an indicator for time 3.</li>
<li>Let <span class="math inline">\(\boldsymbol{\gamma}^{(k)}_{it}\)</span> be a set of up to <span class="math inline">\(k\)</span> additional covariates, possibly including dummy coded categorical variables, such that <span class="math inline">\(k &lt; n - 6\)</span>.</li>
<li>Let <span class="math inline">\(\mathbf{z}_{it}\)</span> be the set of all predictors.</li>
<li>Let <span class="math inline">\(\mathbf{x}_{it} = \begin{bmatrix} 1 &amp; c_{it} &amp; t^{(2)}_{it} &amp; t^{(3)}_{it} &amp; c_{it}t^{(2)}_{it} &amp; c_{it}t^{(3)}_{it} &amp; \boldsymbol{\gamma}^{(k)}_{it} \end{bmatrix}\)</span> be a row-vector of fixed covariate values.</li>
<li>Let <span class="math inline">\(\nabla\)</span> indicate the vector differential operator.</li>
<li>Let <span class="math inline">\(\backslash\)</span> be the set difference operator. That is to say, <span class="math inline">\(A \backslash B = \{x | x \in A \land x \notin B\}\)</span></li>
</ol>
</div>
<div id="linear-expectation" class="section level2">
<h2>Linear Expectation</h2>
<p>Under the identity link function, the expected population-averaged response is modeled as a linear function of the predictors <span class="math inline">\(\mu_{it} = E[y_{it}] = \beta_0 + \beta_1c_{it} + \beta_2t^{(2)}_{it} + \beta_3t^{(3)}_{it} + \beta_4t^{(2)}_{it}c_{it} + \beta_5t^{(3)}_{it}c_{it} + \beta_6\gamma^{(1)}_{it} + ... + \beta_k\gamma^{(k)}_{it} = \mathbf{x}_{it}\boldsymbol{\beta}\)</span> where <span class="math inline">\(\boldsymbol{\beta} = \begin{bmatrix} \beta_1 &amp; \beta_2 &amp; \beta_3 &amp; \beta_4 &amp; \beta_5 &amp; \beta_6 &amp; \cdots &amp; \beta_k \end{bmatrix}^{T}\)</span>.</p>
</div>
<div id="treatment-effect" class="section level2">
<h2>Treatment Effect</h2>
<p>If we assume that the causal effects are identifiable, we can derive the marginal treatment effect for subject <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> shown in equation <a href="#eq:condEff">(1)</a> <span class="citation">(<a href="#ref-hernan2006estimating">Hernán and Robins 2006</a>)</span>.</p>
<p><span class="math display" id="eq:condEff">\[\begin{equation}
\begin{split}
y_{d_{it}} = E[y | c_{it} = 1, \mathbf{z}_{it} \backslash c_{it}] - E[y |c_{it} = 0, \mathbf{z}_{it} \backslash c_{it}] = \\
\beta_0 + \beta_1 + \beta_2t^{(2)}_{it} + \beta_3t^{(3)}_{it} + \beta_4t^{(2)}_{it} + \beta_5t^{(3)}_{it} + \beta_6\gamma^{(1)}_{it} + ... + \beta_k\gamma^{(k)}_{it} \\
- (\beta_0 + \beta_2t^{(2)}_{it} + \beta_3t^{(3)}_{it} + \beta_6\gamma^{(1)}_{it} + ... + \beta_k\gamma^{(k)}_{it}) = \\
\beta_1 + \beta_4t^{(2)}_{it} + \beta_5t^{(3)}_{it}
\end{split}
\tag{1}
\end{equation}\]</span></p>
<p>Treating <span class="math inline">\(t^{(2)}_{it}\)</span> as random in the expectation, applying the law of total expectation, and since <span class="math inline">\(t^{(2)}_{it}\)</span> partitions the sample space, we can calculate the treatment effect that is unconditional on time 2 as shown in equation <a href="#eq:ame">(2)</a> <span class="citation">(<a href="#ref-bain1992introduction">Bain and Engelhardt 1992</a>)</span>.</p>
<p><span class="math display" id="eq:ame">\[\begin{equation}
\begin{split}
E_{t_{it}^{(2)}}[E[y_d|t^{(2)}_{it}, t^{(3)}_{it}]] = \\
E[y_d|t^{(3)}_{it}] = \\
E[y_d|t^{(2)}_{it} = 0, t^{(3)}_{it}]Pr[t^{(2)}_{it} = 0] + E[y_d|t^{(2)}_{it} = 1, t^{(3)}_{it}]Pr[t^{(2)}_{it} = 1] = \\
(\beta_1 + \beta_5t^{(3)}_{it})(1 - Pr[t^{(2)} = 1]) + (\beta_1 + \beta_4 + \beta_5t^{(3)}_{it})Pr[t^{(2)} = 1] = \\
\beta_1 - \beta_1Pr[t^{(2)}_{it} = 1] + \beta_5t^{(3)}_{it} - \beta_5t^{(3)}_{it}Pr[t^{(2)}_{it} = 1] + \beta_1Pr[t^{(2)}_{it} = 1] + \beta_4Pr[t^{(2)}_{it} = 1] + \beta_5t^{(3)}_{it}Pr[t^{(2)}_{it} = 1] = \\
\beta_1 + \beta_5t^{(3)}_{it} + \beta_1Pr[t^{(2)}_{it} = 1]
\end{split}
\tag{2}
\end{equation}\]</span></p>
<p>Therefore the marginal treatment effect at time 3 that is unconditional on the treatment effect at time 2 is <span class="math inline">\(E[y_d|t^{(3)}_{it} = 1] = \beta_1 + \beta_5 + \beta_1Pr[t^{(2)}_{it} = 1]\)</span>. Let <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span> be a consistent estimator of <span class="math inline">\(\boldsymbol{\beta}\)</span>, then the corresponding estimate of the population parameter is <span class="math inline">\(\hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\hat{Pr}[t^{(2)}_{it} = 1]\)</span>.</p>
</div>
<div id="approximate-standard-error-of-the-treatment-effect-estimate" class="section level2">
<h2>Approximate Standard Error of the Treatment Effect Estimate</h2>
<p>The predicted values of <span class="math inline">\(y_{it}\)</span> equal to <span class="math inline">\(\hat{\mu}_{it}\)</span> is a function of the predictors <span class="math inline">\(\mathbf{x}_{it}\)</span> and <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span>, call it <span class="math inline">\(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}})\)</span>. Let <span class="math inline">\(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}})) = \hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\bar{t}\)</span> be the function that transforms the predicted values to the treatment effects at time 3 that are unconditional on time 2.</p>
<p>Let <span class="math inline">\(\Sigma\)</span> be the variance-covariance of <span class="math inline">\(\boldsymbol{\beta}\)</span>. The Delta Method is a generalization of the central limit theorem that allows us to find the approximate sampling variance of a scalar-valued function of our estimators <span class="citation">(<a href="#ref-doob1935limiting">Doob 1935</a>; <a href="#ref-dowd2014computation">Dowd, Greene, and Norton 2014</a>)</span>. As seen above, <span class="math inline">\(g\)</span> is such a function. Therefore by the Delta Method we have <span class="math inline">\(Var(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}}))) \approx \nabla g(f(\mathbf{x}_{it}, \boldsymbol{\beta}))^T \cdot \Sigma \cdot \nabla g(f(\mathbf{x}_{it}, \boldsymbol{\beta}))\)</span>. If we replace the population parameters with their consistent estimators and take the square root, we have the approximate standard error of the marginal treatment effect that is unconditional on time 2. Equation <a href="#eq:grad">(3)</a> shows the derivation of the gradient, and equation <a href="#eq:variance">(4)</a> shows the approximate variance of the estimator, followed by its standard error in equation <a href="#eq:se">(5)</a>.</p>
<p><span class="math display" id="eq:grad">\[\begin{equation}
\begin{split}
\nabla g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}})) =
\begin{bmatrix}
\frac{\partial (\hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\bar{t})}{\partial \hat{\beta_0}} \\
\frac{\partial (\hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\bar{t})}{\partial \hat{\beta_1}} \\
\vdots \\
\frac{\partial (\hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\bar{t})}{\partial \hat{\beta_k}}
\end{bmatrix} = \begin{bmatrix}  0 \\ 1 + \bar{t} \\ 0 \\ 0 \\ 0 \\ 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix}
\end{split}
\tag{3}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:variance">\[\begin{equation}
\begin{split}
Var(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}}))) \approx \begin{bmatrix} 0 &amp; 1 + \bar{t} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \end{bmatrix} \cdot \hat{\Sigma} \cdot \begin{bmatrix} 0 \\1 + \bar{t} \\ 0 \\ 0 \\ 0 \\ 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix}
\end{split}
\tag{4}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:se">\[\begin{equation}
\begin{split}
SE(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}}))) = \sqrt{Var(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}})))}
\end{split}
\tag{5}
\end{equation}\]</span></p>
</div>
</div>
<div id="simulation" class="section level1">
<h1>Simulation</h1>
<div id="data-generating-process" class="section level2">
<h2>Data Generating Process</h2>
<p>The data generating process will assume that the mean response for observation <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> is modeled as a function of <span class="math inline">\(c_{it}\)</span>, <span class="math inline">\(t^{(2)}_{it}\)</span>, and <span class="math inline">\(t^{(3)}_{it}\)</span> with three additional covariates <span class="math inline">\(\gamma^{(1)}_{it}\)</span>, <span class="math inline">\(\gamma^{(2)}_{it}\)</span>, and <span class="math inline">\(\gamma^{(3)}_{it}\)</span> (Equation <a href="#eq:simmu">(6)</a>). Therefore the conditional expectation of observation <span class="math inline">\(i\)</span> at times 1, 2, and 3 are as seen in equations <a href="#eq:simmut1">(7)</a>, <a href="#eq:simmut2">(8)</a>, and <a href="#eq:simmut3">(9)</a>, respectively.</p>
<p><span class="math display" id="eq:simmu">\[\begin{equation}
\begin{split}
\mu_{it} = E[y_{it}] = \\ \beta_0 + \beta_1c_{it} + \beta_2t^{(2)}_{it} + \beta_3t^{(3)}_{it} + \beta_4t^{(2)}_{it}c_{it} + \beta_5t^{(3)}_{it}c_{it} + \beta_6\gamma^{(1)}_{it} + \beta_7\gamma^{(2)}_{it} + \beta_8\gamma^{(3)}_{it}
\end{split}
\tag{6}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:simmut1">\[\begin{equation}
\begin{split}
E[y|t^{(2)}_{it} = 0, t^{(3)}_{it} = 0] = \\ \beta_0 + \beta_1c_{it} + \beta_6\gamma^{(1)}_{it} + \beta_7\gamma^{(2)}_{it} + \beta_8\gamma^{(3)}_{it}
\end{split}
\tag{7}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:simmut2">\[\begin{equation}
\begin{split}
E[y|t^{(2)}_{it} = 1, t^{(3)}_{it} = 0] = \\ \beta_0 + \beta_1c_{it} + \beta_2 +  \beta_4c_{it} + \beta_6\gamma^{(1)}_{it} + \beta_7\gamma^{(2)}_{it} + \beta_8\gamma^{(3)}_{it}
\end{split}
\tag{8}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:simmut3">\[\begin{equation}
\begin{split}
E[y|t^{(2)}_{it} = 0, t^{(3)}_{it} = 1] = \\ \beta_0 + \beta_1c_{it} + \beta_3 + \beta_5c_{it} + \beta_6\gamma^{(1)}_{it} + \beta_7\gamma^{(2)}_{it} + \beta_8\gamma^{(3)}_{it}
\end{split}
\tag{9}
\end{equation}\]</span></p>
<p>Equations <a href="#eq:simmut1">(7)</a>, <a href="#eq:simmut2">(8)</a>, and <a href="#eq:simmut3">(9)</a> also gives us the marginal treatment effect at each time.</p>
<ol style="list-style-type: decimal">
<li>The marginal treatment effect at time 1 is <span class="math inline">\(\beta_1\)</span>.</li>
<li>The marginal treatment effect at time 2 is <span class="math inline">\(\beta_1 + \beta_4\)</span>.</li>
<li>The marginal treatment effect at time 3 is <span class="math inline">\(\beta_1 + \beta_5\)</span>.</li>
</ol>
<p>Furthermore, we will assume that the response over time is generated from a multivariate normal distribution, shown in Equation <a href="#eq:simd">(10)</a>.</p>
<p><span class="math display" id="eq:simd">\[\begin{equation}
\begin{split}
y_i \sim N_3 \Bigg(
\begin{bmatrix}
E[y|t^{(2)}_{it} = 0, t^{(3)}_{it} = 0, \gamma^{(1)}_{it}, \gamma^{(2)}_{it}, \gamma^{(3)}_{it}] \\
E[y|t^{(2)}_{it} = 1, t^{(3)}_{it} = 0, \gamma^{(1)}_{it}, \gamma^{(2)}_{it}, \gamma^{(3)}_{it}] \\
E[y|t^{(2)}_{it} = 9, t^{(3)}_{it} = 1, \gamma^{(1)}_{it}, \gamma^{(2)}_{it}, \gamma^{(3)}_{it}] \\
\end{bmatrix},
\begin{bmatrix}
var(y_{i1}) &amp; cov(y_{i1}, y_{i2}) &amp; cov(y_{i1}, y_{i4}) \\
cov(y_{i2}, y_{i1}) &amp; var(y_{i2}) &amp; cov(y_{i2}, y_{i3}) \\
cov(y_{i3}, y_{i1}) &amp; cov(y_{i3}, y_{i2}) &amp; var(y_{i3})
\end{bmatrix}
\Bigg)
\end{split}
\tag{10}
\end{equation}\]</span></p>
<p>For this simulation, we will assume the following population parameters:</p>
<ol style="list-style-type: decimal">
<li>The intercept term is 5.
<ul>
<li><span class="math inline">\(\beta_0 = 5\)</span></li>
</ul></li>
<li>The marginal treatment effect at time 1 is 0.
<ul>
<li><span class="math inline">\(\beta_1 = 1\)</span></li>
</ul></li>
<li>The marginal treatment effect at time 2 is 1.
<ul>
<li><span class="math inline">\(\beta_1 + \beta_4 = 2\)</span>, which implies <span class="math inline">\(\beta_4 = 1\)</span></li>
</ul></li>
<li>The marginal treatment effect at time 3 is 2.
<ul>
<li><span class="math inline">\(\beta_1 + \beta_5 = 3\)</span>, which implies <span class="math inline">\(\beta_5 = 2\)</span></li>
</ul></li>
<li>For fixed values of all other predictors, the effect at time 2 is 3.
<ul>
<li><span class="math inline">\(\beta_2 = 3\)</span></li>
</ul></li>
<li>For fixed values of all other predictors, the effect at time 3 is 2.
<ul>
<li><span class="math inline">\(\beta_3 = 2\)</span></li>
</ul></li>
<li>The partial effects of all other predictors (or first discrete differences) on the outcome are 6, 5, and 8.
<ul>
<li><span class="math inline">\(\beta_6 = 6\)</span>, <span class="math inline">\(\beta_7 = 5\)</span>, <span class="math inline">\(\beta_8 = 4\)</span></li>
</ul></li>
</ol>
<p>Under these assumptions, and assuming every observation is measured at every time point, the population parameter for the treatment effect that is unconditional on time 2 is <span class="math inline">\(\beta_1 + \beta_5 + \beta_1 \bar{t}^{(2)} = 1 + 2 + 1/3 = 3.33\)</span>.</p>
</div>
<div id="simulated-data" class="section level2">
<h2>Simulated Data</h2>
<p>The simulation data is created using the data generating process described above.</p>
<pre class="r"><code># Set the seed number so that the simulation is reproducible.
set.seed(123)

# Specify the number of independent observations.
n = 100

# Generate the condition assignment as well as the additional confounders,
C = rbinom(n, 1, prob = 1/2)
gamma1 = rnorm(n, mean = 0, sd = 1)
gamma2 = rnorm(n, mean = 0, sd = 1)
gamma3 = rnorm(n, mean = 0, sd = 1)

# The population parameters are used in specifying conditional expectation for the outcome.
beta0 = 5; beta1 = 1; beta2 = 3; beta3 = 2; beta4 = 1; beta5 = 2; beta6 = 6; beta7 = 5; beta8 = 4

# The outcome at each time point depends on the vectors of predictors and the parameter values.
mu_t1 &lt;- beta0 + beta1*C + beta6*gamma1 + beta7*gamma2 + beta8*gamma3
mu_t2 &lt;- beta0 + beta1*C + beta2 + beta4*C + beta6*gamma1 + beta7*gamma2 + beta8*gamma3
mu_t3 &lt;- beta0 + beta1*C + beta3 + beta5*C + beta6*gamma1 + beta7*gamma2 + beta8*gamma3

# The expected value of the outcome at each time point.
mu &lt;- cbind(mu_t1, mu_t2, mu_t3)

# Covariance/correlation matrix for the outcomes measured on the same observation over time.
sim_sigma = diag(3)

rownames(sim_sigma) &lt;- c(&quot;Time1&quot;, &quot;Time2&quot;, &quot;Time3&quot;)
colnames(sim_sigma) &lt;- c(&quot;Time1&quot;, &quot;Time2&quot;, &quot;Time3&quot;)

sim_sigma[&quot;Time1&quot;, &quot;Time2&quot;] &lt;- 0.5
sim_sigma[&quot;Time2&quot;, &quot;Time1&quot;] &lt;- 0.5

sim_sigma[&quot;Time1&quot;, &quot;Time3&quot;] &lt;- 0.25
sim_sigma[&quot;Time3&quot;, &quot;Time1&quot;] &lt;- 0.25

sim_sigma[&quot;Time2&quot;, &quot;Time3&quot;] &lt;- 0.5
sim_sigma[&quot;Time3&quot;, &quot;Time2&quot;] &lt;- 0.5

# Generate multivariate normal random variables using the mean vectors and corresponding correlation of the outcomes over time.
outcomeFun &lt;- function(x) {
  res &lt;- rmvnorm(1, x, sigma = sim_sigma)
  return(res)
}

y &lt;- t(apply(mu, 1, outcomeFun))
y &lt;- melt(y)

# The simulated data set.
d &lt;- cbind(y, rep(C, 3), rep(gamma1, 3), rep(gamma2, 3), rep(gamma3, 3))

colnames(d) &lt;- c(&quot;id&quot;, &quot;Time&quot;, &quot;Y&quot;, &quot;C&quot;, &quot;gamma1&quot;, &quot;gamma2&quot;, &quot;gamma3&quot;)

d$Time &lt;- factor(d$Time, levels = c(1,2,3))

d &lt;- d[order(d$id, d$Time), ]

rownames(d) &lt;- NULL

d_DT &lt;- datatable(d, escape = FALSE,
                  extensions = c(&#39;Buttons&#39;, &#39;KeyTable&#39;),
                  class = &#39;cell-border stripe&#39;,
                  rownames = TRUE,
                  options = list(
                    dom = &#39;Bfrtip&#39;,
                    pageLength = 5,
                    deferRender = TRUE,
                    responsive = TRUE,
                    scrollX = TRUE,
                    scrollCollaspe = TRUE,
                    paging = TRUE,
                    autoWidth = FALSE,
                    keys = TRUE,
                    buttons = c(&#39;copy&#39;, &#39;csv&#39;, &#39;excel&#39;, &#39;pdf&#39;, &#39;print&#39;)
                  ))

d_DT %&gt;% formatRound(c(&quot;Y&quot;, &quot;gamma1&quot;, &quot;gamma2&quot;, &quot;gamma3&quot;), 2)</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ba72ed2f891bcbf14280" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ba72ed2f891bcbf14280">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","KeyTable"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],[1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10,10,11,11,11,12,12,12,13,13,13,14,14,14,15,15,15,16,16,16,17,17,17,18,18,18,19,19,19,20,20,20,21,21,21,22,22,22,23,23,23,24,24,24,25,25,25,26,26,26,27,27,27,28,28,28,29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,37,37,37,38,38,38,39,39,39,40,40,40,41,41,41,42,42,42,43,43,43,44,44,44,45,45,45,46,46,46,47,47,47,48,48,48,49,49,49,50,50,50,51,51,51,52,52,52,53,53,53,54,54,54,55,55,55,56,56,56,57,57,57,58,58,58,59,59,59,60,60,60,61,61,61,62,62,62,63,63,63,64,64,64,65,65,65,66,66,66,67,67,67,68,68,68,69,69,69,70,70,70,71,71,71,72,72,72,73,73,73,74,74,74,75,75,75,76,76,76,77,77,77,78,78,78,79,79,79,80,80,80,81,81,81,82,82,82,83,83,83,84,84,84,85,85,85,86,86,86,87,87,87,88,88,88,89,89,89,90,90,90,91,91,91,92,92,92,93,93,93,94,94,94,95,95,95,96,96,96,97,97,97,98,98,98,99,99,99,100,100,100],["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],[9.392963608509215,10.23999527780113,10.14396232028482,7.347417028311937,10.70406371899006,11.53557460830361,5.176489743195336,7.482455330712097,4.684650501122753,12.02041694324856,14.1472158086548,14.3574187887883,11.04204962841076,15.67380227636184,15.51307474467247,12.14338726295747,15.40676549353316,13.50632541406641,4.790379612559036,8.234772373484782,10.14124963560268,8.542154663026459,13.52774266784463,14.68680487850429,11.42022384336306,14.5002654196299,14.11519865371407,-1.747275054732116,0.8653804080534937,-1.422823716630549,11.55485023693048,15.68724896838264,15.6762456335627,-5.982233467971884,-1.692998714457746,-1.874685148147139,-1.998825593431441,0.831852842349931,1.22878204748681,21.25609705649612,24.23557599548472,23.08778599111533,6.245422355650014,7.959472689032632,6.98292091710155,16.83942622154611,19.36745138347364,20.26943508796697,9.029217221283242,12.67365528600905,12.05729923928295,-5.414491311032878,-2.020595986821295,-2.42738700683303,11.76126032633122,13.09976389451241,12.87752452295357,21.1178215941445,24.24479034725323,24.65959498102175,5.961678001893139,9.894434770465161,10.10113330138834,-4.157155642263621,-0.7582915977931097,-2.339920963036148,14.67165672423506,19.11456093745347,19.21581500464044,6.744821154369859,12.4026292542007,11.47375713644145,1.934467605986343,6.605182511160372,5.202864864236617,5.055241374494671,11.01905775206783,9.454884221975558,6.374032584216059,8.195923372450491,8.7943284420395,0.8682500376482736,4.64971607594398,3.669618775996358,9.800958276262602,12.1589977411123,12.40149844020176,2.580982437896354,3.474333005942917,4.711681582326761,-6.969251759309259,-1.672297767253049,-1.322983249190362,17.23548135889122,20.96167595984695,21.55176323216037,4.016436049946352,7.993594534192773,5.85903194228653,3.360033449213851,9.665906961246431,9.68358663551137,3.655867835601828,6.975910687754301,6.073193326252158,4.209000370788377,9.790953440960594,8.093415532625505,19.2476317975309,23.01497345472256,23.80305556510596,14.35445714395373,17.89781438760025,16.31790002088993,5.261082039490832,9.981804764489421,8.84910175493113,11.85513178736866,13.84349329075275,13.33615784268738,18.41042912280652,19.60705175419696,17.55395676729526,10.61424070767984,13.66155641242015,12.95288441542097,13.09020047893963,14.70388009335677,13.93033237721152,-5.737787067215452,-2.513359513047545,-3.26862496812941,15.99886272183459,18.24469732836063,17.46593461142632,12.57490450307388,15.557960821974,13.40295165730197,30.05624347771473,31.61984215356681,30.55571124077959,4.106410328972139,6.824502405448791,3.946506477514623,-0.5496594434133328,2.170750074521346,2.363926510671341,-0.7825963696059024,3.433874060174829,3.55282985860365,8.141698173790822,11.04788520184879,11.55217461155706,10.42865312928292,11.84571744096097,11.6958148518856,-1.927281083053157,1.316705443472809,2.978640339147714,1.340973647919351,4.363922581653452,3.596766592706921,-2.688442994334647,0.7288647028863795,0.01347065561134964,2.962653894363822,6.443630711213842,5.867491299191524,-12.66289097724391,-8.899776668002257,-8.924823360433994,-6.438928540078741,-2.882191117058947,-2.584130756253671,18.25152534546387,22.02338615728698,22.35720404800514,18.57664183308814,21.6727129480718,19.97254168216157,8.667022045645268,11.67111172721463,10.91250985283924,13.58200069026701,17.94566277443424,16.16476769480436,-4.298681240777629,-1.976780391090409,-3.834846254394251,-0.628534383278579,2.256651559755635,1.140705418890555,3.208165245454749,6.019568578424605,7.348633568445853,18.59367930124974,20.25541032712673,20.39911761113336,6.288868452080722,8.30512222319407,8.915938971020974,-6.945002948547427,-1.58891349186481,-2.051241725404215,2.678743367642165,4.494903697527183,5.203717401048982,-4.540938343912998,-1.397028024814368,-2.629838940343387,4.021877074568729,8.845466700335287,7.802134271037975,9.419553307904859,11.56544812524688,12.22188193407652,3.88186841271364,7.857403601616591,7.158965873961468,9.820557961780789,13.19854458807964,10.49037073024046,11.43731151998387,15.14552773298654,13.72912547693243,5.617339738069239,8.112955239775276,6.493379716904009,1.169551428507309,5.21338600594853,4.201283388216848,5.067343027213623,8.407926528159136,9.587828241669397,7.973835839745052,11.61788729038394,11.20392296844082,-1.213209790861413,2.542323410327973,0.3252033345132743,25.00579773107605,30.45539018508333,30.16706282500695,3.242339094003864,7.613853365142234,6.488835417012835,2.939523352604109,4.882235872514456,6.072569934621441,7.907185831051777,11.31274664418964,10.27277260855006,-9.01703590887181,-6.909879794758742,-6.303677199157927,-3.510712386711799,-1.026680887186569,-2.551061440027974,-9.674679779273697,-6.103175802614295,-5.758916358757839,10.97996054302243,17.00046519624878,16.02057446898647,22.87872556007999,24.26216397607606,25.55531498177357,-8.785318981062725,-5.903876755040081,-4.860931339453833,6.563169692964752,10.91954539902699,10.52187511499889,5.795637866930221,9.213849077219018,10.45639413485148,9.494599889411461,11.43211642041603,10.14478054003226,-6.890850635153033,-5.127017754965835,-6.304973134779316,-5.252601539595527,-2.62790782203392,-4.88687262179749,2.523536201620763,7.003322248561592,7.192931947826779,-2.469958552960122,0.6113226628058882,0.2567136725241845,0.4026162463632842,3.413741658036397,2.713211918593228,10.14413422575367,13.91442320220474,11.76740141703953,-0.05106131064325324,4.843465356847497,5.092539358843368],[0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1],[0.2533185139947548,0.2533185139947548,0.2533185139947548,-0.02854675534870302,-0.02854675534870302,-0.02854675534870302,-0.04287045729131609,-0.04287045729131609,-0.04287045729131609,1.368602284014458,1.368602284014458,1.368602284014458,-0.2257709856592676,-0.2257709856592676,-0.2257709856592676,1.51647060442954,1.51647060442954,1.51647060442954,-1.548752804230221,-1.548752804230221,-1.548752804230221,0.5846137496360692,0.5846137496360692,0.5846137496360692,0.1238542438446138,0.1238542438446138,0.1238542438446138,0.2159415687439727,0.2159415687439727,0.2159415687439727,0.3796394827598821,0.3796394827598821,0.3796394827598821,-0.5023234531093023,-0.5023234531093023,-0.5023234531093023,-0.3332073836694201,-0.3332073836694201,-0.3332073836694201,-1.018575383107089,-1.018575383107089,-1.018575383107089,-1.071791226475578,-1.071791226475578,-1.071791226475578,0.3035286414042581,0.3035286414042581,0.3035286414042581,0.4482097786294262,0.4482097786294262,0.4482097786294262,0.05300422673050414,0.05300422673050414,0.05300422673050414,0.9222674678797376,0.9222674678797376,0.9222674678797376,2.050084685627144,2.050084685627144,2.050084685627144,-0.4910311660565353,-0.4910311660565353,-0.4910311660565353,-2.309168875640812,-2.309168875640812,-2.309168875640812,1.005738524462257,1.005738524462257,1.005738524462257,-0.7092007625823926,-0.7092007625823926,-0.7092007625823926,-0.688008616467358,-0.688008616467358,-0.688008616467358,1.025571369696699,1.025571369696699,1.025571369696699,-0.2847730070510089,-0.2847730070510089,-0.2847730070510089,-1.220717712254536,-1.220717712254536,-1.220717712254536,0.1813034797491502,0.1813034797491502,0.1813034797491502,-0.1388913624390446,-0.1388913624390446,-0.1388913624390446,0.005764185899886933,0.005764185899886933,0.005764185899886933,0.3852804011263305,0.3852804011263305,0.3852804011263305,-0.3706600317924094,-0.3706600317924094,-0.3706600317924094,0.644376548518833,0.644376548518833,0.644376548518833,-0.2204865618187506,-0.2204865618187506,-0.2204865618187506,0.3317819639156969,0.3317819639156969,0.3317819639156969,1.096839013149348,1.096839013149348,1.096839013149348,0.4351814908338029,0.4351814908338029,0.4351814908338029,-0.3259315855312268,-0.3259315855312268,-0.3259315855312268,1.148807618451094,1.148807618451094,1.148807618451094,0.9935038559621194,0.9935038559621194,0.9935038559621194,0.54839695950807,0.54839695950807,0.54839695950807,0.2387317351114412,0.2387317351114412,0.2387317351114412,-0.6279060760393714,-0.6279060760393714,-0.6279060760393714,1.360652448530008,1.360652448530008,1.360652448530008,-0.6002595871471269,-0.6002595871471269,-0.6002595871471269,2.187332993016577,2.187332993016577,2.187332993016577,1.532610626185189,1.532610626185189,1.532610626185189,-0.2357003591004769,-0.2357003591004769,-0.2357003591004769,-1.026420900306781,-1.026420900306781,-1.026420900306781,-0.710406563699301,-0.710406563699301,-0.710406563699301,0.2568837091565295,0.2568837091565295,0.2568837091565295,-0.2466918784623736,-0.2466918784623736,-0.2466918784623736,-0.3475425993977332,-0.3475425993977332,-0.3475425993977332,-0.9516185672650157,-0.9516185672650157,-0.9516185672650157,-0.04502772480892027,-0.04502772480892027,-0.04502772480892027,-0.7849044694570758,-0.7849044694570758,-0.7849044694570758,-1.667941936588137,-1.667941936588137,-1.667941936588137,-0.3802265202877624,-0.3802265202877624,-0.3802265202877624,0.918996609060766,0.918996609060766,0.918996609060766,-0.5753469626083919,-0.5753469626083919,-0.5753469626083919,0.6079643222250334,0.6079643222250334,0.6079643222250334,-1.617882708289164,-1.617882708289164,-1.617882708289164,-0.05556196552453944,-0.05556196552453944,-0.05556196552453944,0.5194072039434623,0.5194072039434623,0.5194072039434623,0.3011533621667144,0.3011533621667144,0.3011533621667144,0.1056761941489433,0.1056761941489433,0.1056761941489433,-0.6407060083053764,-0.6407060083053764,-0.6407060083053764,-0.8497043460335822,-0.8497043460335822,-0.8497043460335822,-1.024128790604913,-1.024128790604913,-1.024128790604913,0.1176465971001259,0.1176465971001259,0.1176465971001259,-0.9474746141848022,-0.9474746141848022,-0.9474746141848022,-0.4905574437006683,-0.4905574437006683,-0.4905574437006683,-0.2560921921982472,-0.2560921921982472,-0.2560921921982472,1.843862005232207,1.843862005232207,1.843862005232207,-0.6519499016954585,-0.6519499016954585,-0.6519499016954585,0.2353865722848569,0.2353865722848569,0.2353865722848569,0.07796084956371077,0.07796084956371077,0.07796084956371077,-0.9618566341301286,-0.9618566341301286,-0.9618566341301286,-0.07130808612359867,-0.07130808612359867,-0.07130808612359867,1.444550858423349,1.444550858423349,1.444550858423349,0.4515040530792147,0.4515040530792147,0.4515040530792147,0.04123292199293993,0.04123292199293993,0.04123292199293993,-0.4224968323396248,-0.4224968323396248,-0.4224968323396248,-2.053247221540516,-2.053247221540516,-2.053247221540516,1.131337213414175,1.131337213414175,1.131337213414175,-1.460640070924822,-1.460640070924822,-1.460640070924822,0.7399475108773345,0.7399475108773345,0.7399475108773345,1.909103569217483,1.909103569217483,1.909103569217483,-1.443893160971799,-1.443893160971799,-1.443893160971799,0.7017843353747109,0.7017843353747109,0.7017843353747109,-0.262197489402468,-0.262197489402468,-0.262197489402468,-1.572144159145488,-1.572144159145488,-1.572144159145488,-1.514667653781751,-1.514667653781751,-1.514667653781751,-1.601536173574593,-1.601536173574593,-1.601536173574593,-0.530906522170303,-0.530906522170303,-0.530906522170303,-1.4617555849959,-1.4617555849959,-1.4617555849959,0.6879167729758275,0.6879167729758275,0.6879167729758275,2.100108940525672,2.100108940525672,2.100108940525672,-1.287030476035179,-1.287030476035179,-1.287030476035179],[0.7877388474751781,0.7877388474751781,0.7877388474751781,0.7690422410009099,0.7690422410009099,0.7690422410009099,0.3322025789501177,0.3322025789501177,0.3322025789501177,-1.008376608277008,-1.008376608277008,-1.008376608277008,-0.1194526066306587,-0.1194526066306587,-0.1194526066306587,-0.2803953351702467,-0.2803953351702467,-0.2803953351702467,0.5629895332204798,0.5629895332204798,0.5629895332204798,-0.372438756103829,-0.372438756103829,-0.372438756103829,0.9769733866856207,0.9769733866856207,0.9769733866856207,-0.3745808577670138,-0.3745808577670138,-0.3745808577670138,1.052711465579332,1.052711465579332,1.052711465579332,-1.049177006666066,-1.049177006666066,-1.049177006666066,-1.260155244758112,-1.260155244758112,-1.260155244758112,3.241039934942405,3.241039934942405,3.241039934942405,-0.4168575881604318,-0.4168575881604318,-0.4168575881604318,0.2982275915407153,0.2982275915407153,0.2982275915407153,0.6365696740338487,0.6365696740338487,0.6365696740338487,-0.4837806257087436,-0.4837806257087436,-0.4837806257087436,0.516862044313609,0.516862044313609,0.516862044313609,0.368964527385086,0.368964527385086,0.368964527385086,-0.2153805076416934,-0.2153805076416934,-0.2153805076416934,0.06529303352531526,0.06529303352531526,0.06529303352531526,-0.034067253738464,-0.034067253738464,-0.034067253738464,2.128451899016181,2.128451899016181,2.128451899016181,-0.7413360962728284,-0.7413360962728284,-0.7413360962728284,-1.095996267074664,-1.095996267074664,-1.095996267074664,0.03778839917107882,0.03778839917107882,0.03778839917107882,0.310480749443137,0.310480749443137,0.310480749443137,0.4365234789101829,0.4365234789101829,0.4365234789101829,-0.4583653327111057,-0.4583653327111057,-0.4583653327111057,-1.063326133971191,-1.063326133971191,-1.063326133971191,1.26318517608949,1.26318517608949,1.26318517608949,-0.3496503879535547,-0.3496503879535547,-0.3496503879535547,-0.865512862653374,-0.865512862653374,-0.865512862653374,-0.2362795689410965,-0.2362795689410965,-0.2362795689410965,-0.1971758943485522,-0.1971758943485522,-0.1971758943485522,1.10992028971364,1.10992028971364,1.10992028971364,0.08473729219719646,0.08473729219719646,0.08473729219719646,0.7540537851845215,0.7540537851845215,0.7540537851845215,-0.4992920171722608,-0.4992920171722608,-0.4992920171722608,0.2144453095816013,0.2144453095816013,0.2144453095816013,-0.3246859114908347,-0.3246859114908347,-0.3246859114908347,0.09458352817357142,0.09458352817357142,0.09458352817357142,-0.8953633579775416,-0.8953633579775416,-0.8953633579775416,-1.310801533327972,-1.310801533327972,-1.310801533327972,1.997213384747967,1.997213384747967,1.997213384747967,0.6007088236724176,0.6007088236724176,0.6007088236724176,-1.251271361624944,-1.251271361624944,-1.251271361624944,-0.6111659166804209,-0.6111659166804209,-0.6111659166804209,-1.18548008459731,-1.18548008459731,-1.18548008459731,2.19881034888372,2.19881034888372,2.19881034888372,1.31241297643351,1.31241297643351,1.31241297643351,-0.265145056696353,-0.265145056696353,-0.265145056696353,0.5431940592320895,0.5431940592320895,0.5431940592320895,-0.4143399479188597,-0.4143399479188597,-0.4143399479188597,-0.4762468946155784,-0.4762468946155784,-0.4762468946155784,-0.7886028378502425,-0.7886028378502425,-0.7886028378502425,-0.594617267459511,-0.594617267459511,-0.594617267459511,1.65090746733669,1.65090746733669,1.65090746733669,-0.0540281250854405,-0.0540281250854405,-0.0540281250854405,0.1192452364275841,0.1192452364275841,0.1192452364275841,0.243687429599092,0.243687429599092,0.243687429599092,1.232475878485338,1.232475878485338,1.232475878485338,-0.5160638309447803,-0.5160638309447803,-0.5160638309447803,-0.9925071503920374,-0.9925071503920374,-0.9925071503920374,1.67569693240319,1.67569693240319,1.67569693240319,-0.4411632169052855,-0.4411632169052855,-0.4411632169052855,-0.7230659699398736,-0.7230659699398736,-0.7230659699398736,-1.236273118883293,-1.236273118883293,-1.236273118883293,-1.284715722317797,-1.284715722317797,-1.284715722317797,-0.5739734792979869,-0.5739734792979869,-0.5739734792979869,0.6179858171665286,0.6179858171665286,0.6179858171665286,1.109848138929718,1.109848138929718,1.109848138929718,0.707588353835588,0.707588353835588,0.707588353835588,-0.3636572970952526,-0.3636572970952526,-0.3636572970952526,0.05974993738460069,0.05974993738460069,0.05974993738460069,-0.70459646368007,-0.70459646368007,-0.70459646368007,-0.7172181615740102,-0.7172181615740102,-0.7172181615740102,0.8846504989769201,0.8846504989769201,0.8846504989769201,-1.015592578603544,-1.015592578603544,-1.015592578603544,1.955293965492464,1.955293965492464,1.955293965492464,-0.09031959396585161,-0.09031959396585161,-0.09031959396585161,0.2145388266292163,0.2145388266292163,0.2145388266292163,-0.7385277047395734,-0.7385277047395734,-0.7385277047395734,-0.5743886897632697,-0.5743886897632697,-0.5743886897632697,-1.317016132305242,-1.317016132305242,-1.317016132305242,-0.1829253883727273,-0.1829253883727273,-0.1829253883727273,0.4189824049244639,0.4189824049244639,0.4189824049244639,0.32430434416138,0.32430434416138,0.32430434416138,-0.7815364870547514,-0.7815364870547514,-0.7815364870547514,-0.7886219708540015,-0.7886219708540015,-0.7886219708540015,-0.5021987183428608,-0.5021987183428608,-0.5021987183428608,1.496060669846351,1.496060669846351,1.496060669846351,-1.137303620665745,-1.137303620665745,-1.137303620665745,-0.1790515943801984,-0.1790515943801984,-0.1790515943801984,1.902361821678927,1.902361821678927,1.902361821678927,-0.1009748853288084,-0.1009748853288084,-0.1009748853288084,-1.359840703821394,-1.359840703821394,-1.359840703821394,-0.6647694352740622,-0.6647694352740622,-0.6647694352740622,0.4854599789048781,0.4854599789048781,0.4854599789048781],[-0.3756028716697735,-0.3756028716697735,-0.3756028716697735,-0.561876363549783,-0.561876363549783,-0.561876363549783,-0.3439172341284593,-0.3439172341284593,-0.3439172341284593,0.09049664713922118,0.09049664713922118,0.09049664713922118,1.598508771145826,1.598508771145826,1.598508771145826,-0.08856511213888398,-0.08856511213888398,-0.08856511213888398,1.080799496151517,1.080799496151517,1.080799496151517,0.6307541156505666,0.6307541156505666,0.6307541156505666,-0.1136398955061407,-0.1136398955061407,-0.1136398955061407,-1.532902002890598,-1.532902002890598,-1.532902002890598,-0.5211173175525201,-0.5211173175525201,-0.5211173175525201,-0.4898704531384743,-0.4898704531384743,-0.4898704531384743,0.04715443276152723,0.04715443276152723,0.04715443276152723,1.300198677666821,1.300198677666821,1.300198677666821,2.293078973831094,2.293078973831094,2.293078973831094,1.547581058983769,1.547581058983769,1.547581058983769,-0.1331509643289445,-0.1331509643289445,-0.1331509643289445,-1.756527395557637,-1.756527395557637,-1.756527395557637,-0.3887798640717435,-0.3887798640717435,-0.3887798640717435,0.08920722307329454,0.08920722307329454,0.08920722307329454,0.845013004067436,0.845013004067436,0.845013004067436,0.962527968484271,0.962527968484271,0.962527968484271,0.6843094294164646,0.6843094294164646,0.6843094294164646,-1.395274349799468,-1.395274349799468,-1.395274349799468,0.8496430456333551,0.8496430456333551,0.8496430456333551,-0.4465572164272222,-0.4465572164272222,-0.4465572164272222,0.1748027001612557,0.1748027001612557,0.1748027001612557,0.07455117717373456,0.07455117717373456,0.07455117717373456,0.4281667649705055,0.4281667649705055,0.4281667649705055,0.02467498282613994,0.02467498282613994,0.02467498282613994,-1.667475097585663,-1.667475097585663,-1.667475097585663,0.7364959647734421,0.7364959647734421,0.7364959647734421,0.3860265683496758,0.3860265683496758,0.3860265683496758,-0.2656516252782223,-0.2656516252782223,-0.2656516252782223,0.1181445110466807,0.1181445110466807,0.1181445110466807,0.1340386453684634,0.1340386453684634,0.1340386453684634,0.2210194685610021,0.2210194685610021,0.2210194685610021,1.640846165977486,1.640846165977486,1.640846165977486,-0.2190503789334758,-0.2190503789334758,-0.2190503789334758,0.1680653838846575,0.1680653838846575,0.1680653838846575,1.168383873069093,1.168383873069093,1.168383873069093,1.054181023376919,1.054181023376919,1.054181023376919,1.145263110380357,1.145263110380357,1.145263110380357,-0.5774680010595568,-0.5774680010595568,-0.5774680010595568,2.002482730292829,2.002482730292829,2.002482730292829,0.06670087093018297,0.06670087093018297,0.06670087093018297,1.866851844706862,1.866851844706862,1.866851844706862,-1.350902686030712,-1.350902686030712,-1.350902686030712,0.02098358635423748,0.02098358635423748,0.02098358635423748,1.249914570969216,1.249914570969216,1.249914570969216,-0.7152421872227963,-0.7152421872227963,-0.7152421872227963,-0.752688968217742,-0.752688968217742,-0.752688968217742,-0.9385387036068938,-0.9385387036068938,-0.9385387036068938,-1.052513279338737,-1.052513279338737,-1.052513279338737,-0.4371595331803989,-0.4371595331803989,-0.4371595331803989,0.3311791729589819,0.3311791729589819,0.3311791729589819,-2.01421049792072,-2.01421049792072,-2.01421049792072,0.2119804333722918,0.2119804333722918,0.2119804333722918,1.23667504641657,1.23667504641657,1.23667504641657,2.037574018240435,2.037574018240435,2.037574018240435,1.301175992200587,1.301175992200587,1.301175992200587,0.7567747637959615,0.7567747637959615,0.7567747637959615,-1.72673039911433,-1.72673039911433,-1.72673039911433,-0.601506708006782,-0.601506708006782,-0.601506708006782,-0.3520464565826169,-0.3520464565826169,-0.3520464565826169,0.7035239027568945,0.7035239027568945,0.7035239027568945,-0.1056713340037745,-0.1056713340037745,-0.1056713340037745,-1.258648628060172,-1.258648628060172,-1.258648628060172,1.684435708094115,1.684435708094115,1.684435708094115,0.9113912917959627,0.9113912917959627,0.9113912917959627,0.2374302724910258,0.2374302724910258,0.2374302724910258,1.218108610325811,1.218108610325811,1.218108610325811,-1.338774287234972,-1.338774287234972,-1.338774287234972,0.6608202977898003,0.6608202977898003,0.6608202977898003,-0.5229123763134219,-0.5229123763134219,-0.5229123763134219,0.6837455218507125,0.6837455218507125,0.6837455218507125,-0.06082195466007423,-0.06082195466007423,-0.06082195466007423,0.6329607130314509,0.6329607130314509,0.6329607130314509,1.335517615059392,1.335517615059392,1.335517615059392,0.007290090316898794,0.007290090316898794,0.007290090316898794,1.017558636952092,1.017558636952092,1.017558636952092,-1.188434035147979,-1.188434035147979,-1.188434035147979,-0.7216044404360152,-0.7216044404360152,-0.7216044404360152,1.519217711388178,1.519217711388178,1.519217711388178,0.3773879730239293,0.3773879730239293,0.3773879730239293,-2.05222282043373,-2.05222282043373,-2.05222282043373,-1.364037452082375,-1.364037452082375,-1.364037452082375,-0.2007810155891212,-0.2007810155891212,-0.2007810155891212,0.865779404334488,0.865779404334488,0.865779404334488,-0.1018832557152225,-0.1018832557152225,-0.1018832557152225,0.6241874720206527,0.6241874720206527,0.6241874720206527,0.9590053777878254,0.9590053777878254,0.9590053777878254,1.671054828862939,1.671054828862939,1.671054828862939,0.05601673327496193,0.05601673327496193,0.05601673327496193,-0.05198190618089897,-0.05198190618089897,-0.05198190618089897,-1.75323735914227,-1.75323735914227,-1.75323735914227,0.09932759408782749,0.09932759408782749,0.09932759408782749,-0.5718500578955633,-0.5718500578955633,-0.5718500578955633,-0.9740095828040912,-0.9740095828040912,-0.9740095828040912,-0.1799062310475403,-0.1799062310475403,-0.1799062310475403]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>Time<\/th>\n      <th>Y<\/th>\n      <th>C<\/th>\n      <th>gamma1<\/th>\n      <th>gamma2<\/th>\n      <th>gamma3<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","pageLength":5,"deferRender":true,"responsive":true,"scrollX":true,"scrollCollaspe":true,"paging":true,"autoWidth":false,"keys":true,"buttons":["copy","csv","excel","pdf","print"],"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,3,4,5,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"id","targets":1},{"name":"Time","targets":2},{"name":"Y","targets":3},{"name":"C","targets":4},{"name":"gamma1","targets":5},{"name":"gamma2","targets":6},{"name":"gamma3","targets":7}],"order":[],"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script>
</div>
<div id="estimation" class="section level2">
<h2>Estimation</h2>
<p>For estimating <span class="math inline">\(\boldsymbol{\beta} = \hat{\boldsymbol{\beta}}\)</span> we will use the method of longitudinal data analysis described in <span class="citation">Liang and Zeger (<a href="#ref-liang1986longitudinal">1986</a>)</span> with robust variance estimates of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> calculated using the method described in <span class="citation">White (<a href="#ref-white1980heteroskedasticity">1980</a>)</span>. Following this method, we see that the estimates are close to their respective population parameters: <span class="math inline">\(\beta_0 = 5\)</span>, <span class="math inline">\(\beta_1 = 1\)</span>, <span class="math inline">\(\beta_2 = 3\)</span>, <span class="math inline">\(\beta_3 = 2\)</span>, <span class="math inline">\(\beta_4 = 1\)</span>, <span class="math inline">\(\beta_5 = 2\)</span>, <span class="math inline">\(\beta_6 = 6\)</span>, <span class="math inline">\(\beta_7 = 5\)</span>, and <span class="math inline">\(\beta_8 = 4\)</span>.</p>
<pre class="r"><code>fit &lt;- geeglm(Y ~ C + Time + C*Time + gamma1 + gamma2 + gamma3, data = d, id = id, family = gaussian, corstr = &quot;ar1&quot;)

coef(fit)[c(&quot;(Intercept)&quot;, &quot;C&quot;, &quot;Time2&quot;, &quot;Time3&quot;, &quot;C:Time2&quot;, &quot;C:Time3&quot;, &quot;gamma1&quot;, &quot;gamma2&quot;, &quot;gamma3&quot;)]</code></pre>
<pre><code>## (Intercept)           C       Time2       Time3     C:Time2     C:Time3 
##   4.8815462   1.3985718   2.9294477   2.0177424   0.7593363   1.6677978 
##      gamma1      gamma2      gamma3 
##   6.0984678   4.9565371   4.1170882</code></pre>
<p>From the estimated coefficients, we can calculate the estimated marginal treatment effect that unconditional on time 2.</p>
<pre class="r"><code>uncond_t3_effect &lt;- coef(fit)[&quot;C&quot;] + coef(fit)[&quot;C:Time3&quot;] + coef(fit)[&quot;C&quot;]*(1/3)
names(uncond_t3_effect) &lt;- NULL
uncond_t3_effect</code></pre>
<pre><code>## [1] 3.53256</code></pre>
</div>
<div id="standard-error-of-the-estimate" class="section level2">
<h2>Standard Error of the Estimate</h2>
<p>For the simulation, the gradient of function that transforms the linear predictor to the marginal treatment effect that is unconditional on time 2 is as seen in equation <a href="#eq:simGrad">(11)</a>. The approximated variance of the sampling distribution of the estimate is shown in equation <a href="#eq:simVariance">(12)</a>, followed by its standard error in equation <a href="#eq:simSE">(13)</a>.</p>
<p><span class="math display" id="eq:simGrad">\[\begin{equation}
\begin{split}
\nabla g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}})) =
\begin{bmatrix}
\frac{\partial (\hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\bar{t})}{\partial \hat{\beta_0}} \\
\frac{\partial (\hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\bar{t})}{\partial \hat{\beta_1}} \\
\vdots \\
\frac{\partial (\hat{\beta}_1 + \hat{\beta}_5 + \hat{\beta}_1\bar{t})}{\partial \hat{\beta_8}}
\end{bmatrix} = \begin{bmatrix}  0 \\ 1 + \bar{t} \\ 0 \\ 0 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \end{bmatrix}
\end{split}
\tag{11}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:simVariance">\[\begin{equation}
\begin{split}
Var(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}}))) \approx \begin{bmatrix} 0 &amp; 1 + \bar{t} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \end{bmatrix} \cdot \hat{\Sigma} \cdot \begin{bmatrix} 0 \\1 + \bar{t} \\ 0 \\ 0 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \end{bmatrix}
\end{split}
\tag{12}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:simSE">\[\begin{equation}
\begin{split}
SE(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}}))) = \sqrt{Var(g(f(\mathbf{x}_{it}, \boldsymbol{\hat{\beta}})))}
\end{split}
\tag{13}
\end{equation}\]</span></p>
<p>The approximated variance of the sampling distribution of the estimate in the simulated data is shown below.</p>
<pre class="r"><code>sigmaEst &lt;- vcov(fit)[c(&quot;(Intercept)&quot;, &quot;C&quot;, &quot;Time2&quot;, &quot;Time3&quot;, &quot;C:Time2&quot;, &quot;C:Time3&quot;, &quot;gamma1&quot;, &quot;gamma2&quot;, &quot;gamma3&quot;), c(&quot;(Intercept)&quot;, &quot;C&quot;, &quot;Time2&quot;, &quot;Time3&quot;, &quot;C:Time2&quot;, &quot;C:Time3&quot;, &quot;gamma1&quot;, &quot;gamma2&quot;, &quot;gamma3&quot;)]

grad &lt;- matrix(c(0, 1 + 1/3, 0, 0, 0, 1, 0, 0, 0))

uncond_t3_effect_se &lt;- sqrt(t(grad) %*% sigmaEst %*% grad)
uncond_t3_effect_se</code></pre>
<pre><code>##           [,1]
## [1,] 0.1906231</code></pre>
</div>
<div id="inference-and-confidence-intervals" class="section level2">
<h2>Inference and Confidence Intervals</h2>
<p>With the estimate and standard error in hand, statistical inference is straight forward. Let the estimated treatment effect at time 3 unconditional on time 2 be given by <span class="math inline">\(\hat{D}\)</span> so that it’s standard error is given by <span class="math inline">\(SE(\hat{D})\)</span>. Under the null hypothesis, we wish to test <span class="math inline">\(H_0: \hat{D} = 0\)</span>. If the null is true, and by the central limit theorem, the sampling distribution of <span class="math inline">\(\frac{\hat{D}}{SE(\hat{D})}\)</span> converges in distribution to a standard normal, <span class="math inline">\(Z \sim N(0, 1)\)</span>. Therefore our observed test statistic under the null is as seen in equation <a href="#eq:simZval">(14)</a>.</p>
<p><span class="math display" id="eq:simZval">\[\begin{equation}
\begin{split}
Z_{obs} = \frac{\hat{D} - \hat{D}_{H_0}}{SE(\hat{D})} = \frac{\hat{D}}{SE(\hat{D})}
\end{split}
\tag{14}
\end{equation}\]</span></p>
<p>The P-value to test the null hypothesis is two times the upper tail probability of observing <span class="math inline">\(Z_{obs}\)</span> or greater. Assuming that we are willing falsely reject the null hypothesis 5% of the time, the corresponding 95% confidence interval is <span class="math inline">\(\hat{D} \pm 1.96SE(\hat{D})\)</span>.</p>
<pre class="r"><code># P-value
z_obs &lt;- uncond_t3_effect/uncond_t3_effect_se
pval &lt;- 2*pnorm(abs(z_obs), lower.tail = FALSE)
pval</code></pre>
<pre><code>##              [,1]
## [1,] 1.147179e-76</code></pre>
<pre class="r"><code># 95% Confidence Interval
ci_ub &lt;- uncond_t3_effect + 1.96*uncond_t3_effect_se
ci_lb &lt;- uncond_t3_effect - 1.96*uncond_t3_effect_se
paste(&quot;[&quot;, round(ci_ub, 2), &quot;, &quot;, round(ci_lb, 2), &quot;]&quot;, sep = &quot;&quot;)</code></pre>
<pre><code>## [1] &quot;[3.91, 3.16]&quot;</code></pre>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session Info</h1>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.4.1 (2024-06-14)
## Platform: aarch64-apple-darwin20
## Running under: macOS 15.0.1
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: America/New_York
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
## [1] geepack_1.3.12   mvtnorm_1.3-1    DT_0.33          dplyr_1.1.4     
## [5] reshape2_1.4.4   kableExtra_1.4.0 bookdown_0.40    knitr_1.48      
## [9] rmarkdown_2.28  
## 
## loaded via a namespace (and not attached):
##  [1] sass_0.4.9        utf8_1.2.4        generics_0.1.3    tidyr_1.3.1      
##  [5] renv_1.0.10       xml2_1.3.6        stringi_1.8.4     digest_0.6.37    
##  [9] magrittr_2.0.3    evaluate_1.0.1    fastmap_1.2.0     plyr_1.8.9       
## [13] jsonlite_1.8.9    backports_1.5.0   purrr_1.0.2       fansi_1.0.6      
## [17] crosstalk_1.2.1   viridisLite_0.4.2 scales_1.3.0      jquerylib_0.1.4  
## [21] cli_3.6.3         rlang_1.1.4       munsell_0.5.1     cachem_1.1.0     
## [25] yaml_2.3.10       tools_4.4.1       colorspace_2.1-1  broom_1.0.7      
## [29] vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4   stringr_1.5.1    
## [33] htmlwidgets_1.6.4 MASS_7.3-61       pkgconfig_2.0.3   pillar_1.9.0     
## [37] bslib_0.8.0       glue_1.8.0        Rcpp_1.0.13       systemfonts_1.1.0
## [41] xfun_0.48         tibble_3.2.1      tidyselect_1.2.1  rstudioapi_0.16.0
## [45] htmltools_0.5.8.1 svglite_2.1.3     compiler_4.4.1</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bain1992introduction" class="csl-entry">
Bain, Lee J, and Max Engelhardt. 1992. <em>Introduction to Probability and Mathematical Statistics</em>. Brooks/Cole.
</div>
<div id="ref-doob1935limiting" class="csl-entry">
Doob, Joseph L. 1935. <span>“The Limiting Distributions of Certain Statistics.”</span> <em>The Annals of Mathematical Statistics</em> 6 (3): 160–69.
</div>
<div id="ref-dowd2014computation" class="csl-entry">
Dowd, Bryan E, William H Greene, and Edward C Norton. 2014. <span>“Computation of Standard Errors.”</span> <em>Health Services Research</em> 49 (2): 731–50.
</div>
<div id="ref-genz2009" class="csl-entry">
Genz, Alan, and Frank Bretz. 2009. <em>Computation of Multivariate Normal and t Probabilities</em>. Lecture Notes in Statistics. Heidelberg: Springer-Verlag.
</div>
<div id="ref-genz2019" class="csl-entry">
Genz, Alan, Frank Bretz, Tetsuhisa Miwa, Xuefei Mi, Friedrich Leisch, Fabian Scheipl, and Torsten Hothorn. 2019. <em><span class="nocase">mvtnorm</span>: Multivariate Normal and t Distributions</em>. <a href="https://CRAN.R-project.org/package=mvtnorm">https://CRAN.R-project.org/package=mvtnorm</a>.
</div>
<div id="ref-geepack2006" class="csl-entry">
Halekoh, Ulrich, Søren Højsgaard, and Jun Yan. 2006. <span>“The r Package Geepack for Generalized Estimating Equations.”</span> <em>Journal of Statistical Software</em> 15/2: 1–11.
</div>
<div id="ref-hernan2006estimating" class="csl-entry">
Hernán, Miguel A, and James M Robins. 2006. <span>“Estimating Causal Effects from Epidemiological Data.”</span> <em>Journal of Epidemiology &amp; Community Health</em> 60 (7): 578–86.
</div>
<div id="ref-liang1986longitudinal" class="csl-entry">
Liang, Kung-Yee, and Scott L Zeger. 1986. <span>“Longitudinal Data Analysis Using Generalized Linear Models.”</span> <em>Biometrika</em> 73 (1): 13–22.
</div>
<div id="ref-Rlang2019" class="csl-entry">
R Core Team. 2019. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Rstudio" class="csl-entry">
RStudio Team. 2016. <em>RStudio: Integrated Development Environment for r</em>. Boston, MA: RStudio, Inc. <a href="http://www.rstudio.com/">http://www.rstudio.com/</a>.
</div>
<div id="ref-white1980heteroskedasticity" class="csl-entry">
White, Halbert. 1980. <span>“A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity.”</span> <em>Econometrica: Journal of the Econometric Society</em>, 817–38.
</div>
<div id="ref-reshape2" class="csl-entry">
Wickham, Hadley. 2007. <span>“Reshaping Data with the <span class="nocase">reshape</span> Package.”</span> <em>Journal of Statistical Software</em> 21 (12): 1–20. <a href="http://www.jstatsoft.org/v21/i12/">http://www.jstatsoft.org/v21/i12/</a>.
</div>
<div id="ref-dplyr" class="csl-entry">
Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2019. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-bookdown" class="csl-entry">
Xie, Yihui. 2018. <em>Bookdown: Authoring Books and Technical Documents with r Markdown</em>. <a href="https://github.com/rstudio/bookdown">https://github.com/rstudio/bookdown</a>.
</div>
<div id="ref-knitr" class="csl-entry">
———. 2019. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in r</em>. <a href="https://yihui.name/knitr/">https://yihui.name/knitr/</a>.
</div>
<div id="ref-xie2019" class="csl-entry">
Xie, Yihui, Joe Cheng, and Xianying Tan. 2019. <em>DT: A Wrapper of the JavaScript Library ’DataTables’</em>. <a href="https://CRAN.R-project.org/package=DT">https://CRAN.R-project.org/package=DT</a>.
</div>
<div id="ref-yan2002" class="csl-entry">
Yan, Jun. 2002. <span>“Geepack: Yet Another Package for Generalized Estimating Equations.”</span> <em>R-News</em> 2/3: 12–14.
</div>
<div id="ref-yan2004" class="csl-entry">
Yan, Jun, and Jason P. Fine. 2004. <span>“Estimating Equations for Association Structures.”</span> <em>Statistics in Medicine</em> 23: 859–80.
</div>
<div id="ref-kableExtra" class="csl-entry">
Zhu, Hao. 2019. <em>kableExtra: Construct Complex Table with ’Kable’ and Pipe Syntax</em>. <a href="https://CRAN.R-project.org/package=kableExtra">https://CRAN.R-project.org/package=kableExtra</a>.
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "index_files/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
